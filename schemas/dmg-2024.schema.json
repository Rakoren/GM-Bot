{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "DMG 2024 Shard Schema",
  "type": "object",
  "oneOf": [
    {
      "$ref": "#/$defs/dm_advice"
    },
    {
      "$ref": "#/$defs/procedure"
    },
    {
      "$ref": "#/$defs/template"
    },
    {
      "$ref": "#/$defs/map"
    },
    {
      "$ref": "#/$defs/tracking_sheet"
    },
    {
      "$ref": "#/$defs/lore_term"
    },
    {
      "$ref": "#/$defs/bastion_rule"
    },
    {
      "$ref": "#/$defs/treasure_item"
    },
    {
      "$ref": "#/$defs/table"
    },
    {
      "$ref": "#/$defs/list"
    }
  ],
  "$defs": {
    "sourceRef": {
      "type": "object",
      "required": [
        "file",
        "pages",
        "section"
      ],
      "properties": {
        "file": {
          "type": "string"
        },
        "pages": {
          "type": "array",
          "items": {
            "type": "integer"
          }
        },
        "section": {
          "type": "string"
        }
      },
      "additionalProperties": false
    },
    "baseShard": {
      "type": "object",
      "required": [
        "id",
        "name",
        "chapter",
        "status",
        "sourceRef"
      ],
      "properties": {
        "id": {
          "type": "string"
        },
        "name": {
          "type": "string"
        },
        "chapter": {
          "type": "string"
        },
        "status": {
          "type": "string"
        },
        "sourceRef": {
          "$ref": "#/$defs/sourceRef"
        },
        "notes": {
          "type": "array",
          "items": {
            "type": "string"
          }
        }
      }
    },
    "dm_advice": {
      "allOf": [
        {
          "$ref": "#/$defs/baseShard"
        },
        {
          "type": "object",
          "properties": {
            "guidance": {
              "type": "array",
              "items": {
                "type": "string"
              }
            },
            "tags": {
              "type": "array",
              "items": {
                "type": "string"
              }
            }
          },
          "additionalProperties": true
        }
      ]
    },
    "procedure": {
      "allOf": [
        {
          "$ref": "#/$defs/baseShard"
        },
        {
          "type": "object",
          "properties": {
            "steps": {
              "type": "array",
              "items": {
                "type": "string"
              }
            },
            "triggers": {
              "type": "array",
              "items": {
                "type": "string"
              }
            }
          },
          "additionalProperties": true
        }
      ]
    },
    "template": {
      "allOf": [
        {
          "$ref": "#/$defs/baseShard"
        },
        {
          "type": "object",
          "properties": {
            "fields": {
              "type": "array",
              "items": {
                "type": "string"
              }
            },
            "example": {
              "type": "array",
              "items": {
                "type": "string"
              }
            }
          },
          "additionalProperties": true
        }
      ]
    },
    "map": {
      "allOf": [
        {
          "$ref": "#/$defs/baseShard"
        },
        {
          "type": "object",
          "properties": {
            "map_type": {
              "type": "string"
            },
            "image_ref": {
              "type": "string"
            },
            "scale": {
              "type": "string"
            }
          },
          "additionalProperties": true
        }
      ]
    },
    "tracking_sheet": {
      "allOf": [
        {
          "$ref": "#/$defs/baseShard"
        },
        {
          "type": "object",
          "properties": {
            "fields": {
              "type": "array",
              "items": {
                "type": "string"
              }
            },
            "usage": {
              "type": "string"
            }
          },
          "additionalProperties": true
        }
      ]
    },
    "lore_term": {
      "allOf": [
        {
          "$ref": "#/$defs/baseShard"
        },
        {
          "type": "object",
          "properties": {
            "description": {
              "type": "array",
              "items": {
                "type": "string"
              }
            },
            "see_also": {
              "type": "array",
              "items": {
                "type": "string"
              }
            }
          },
          "additionalProperties": true
        }
      ]
    },
    "bastion_rule": {
      "allOf": [
        {
          "$ref": "#/$defs/baseShard"
        },
        {
          "type": "object",
          "properties": {
            "effects": {
              "type": "array",
              "items": {
                "type": "string"
              }
            },
            "costs": {
              "type": "array",
              "items": {
                "type": "string"
              }
            }
          },
          "additionalProperties": true
        }
      ]
    },
    "treasure_item": {
      "allOf": [
        {
          "$ref": "#/$defs/baseShard"
        },
        {
          "type": "object",
          "properties": {
            "item_type": {
              "type": "string"
            },
            "rarity": {
              "type": "string"
            },
            "properties": {
              "type": "array",
              "items": {
                "type": "string"
              }
            }
          },
          "additionalProperties": true
        }
      ]
    },
    "table": {
      "type": "object",
      "required": [
        "id",
        "name",
        "chapter",
        "status",
        "sourceRef",
        "entries"
      ],
      "properties": {
        "id": {
          "type": "string"
        },
        "name": {
          "type": "string"
        },
        "chapter": {
          "type": "string"
        },
        "status": {
          "type": "string"
        },
        "sourceRef": {
          "$ref": "#/$defs/sourceRef"
        },
        "columns": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "entries": {
          "type": "array"
        },
        "notes": {
          "type": "array",
          "items": {
            "type": "string"
          }
        }
      },
      "additionalProperties": true
    },
    "list": {
      "type": "object",
      "required": [
        "id",
        "name",
        "chapter",
        "status",
        "items"
      ],
      "properties": {
        "id": {
          "type": "string"
        },
        "name": {
          "type": "string"
        },
        "chapter": {
          "type": "string"
        },
        "status": {
          "type": "string"
        },
        "items": {
          "type": "array"
        },
        "notes": {
          "type": "array",
          "items": {
            "type": "string"
          }
        }
      },
      "additionalProperties": true
    }
  }
}
